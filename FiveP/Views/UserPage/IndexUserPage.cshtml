@using FiveP.Models;
@model User
@{
    User user = (User)Session["user"];

    ViewBag.Title = "IndexUserPage";
    Layout = "~/Views/Shared/_LayoutUserPage.cshtml";

    FivePEntities db = new FivePEntities();
}
<div class="wrapper">
    <section class="section-profile-cover section-shaped my-0">
        <!-- Circles background -->
        <img class="bg-image" src="~/Content/argon-design-system-master/assets/img/pages/mohamed.jpg" style="width: 100%;">
        <!-- SVG separator -->
        <div class="separator separator-bottom separator-skew">
            <svg x="0" y="0" viewBox="0 0 2560 100" preserveAspectRatio="none" version="1.1" xmlns="http://www.w3.org/2000/svg">
                <polygon class="fill-secondary" points="2560 0 2560 100 0 100"></polygon>
            </svg>
        </div>
    </section>
    <section class="section bg-secondary">
        <div class="container">
            <div class="card card-profile shadow mt--300">
                <div class="px-4">
                    <div class="row justify-content-center">
                        <div class="col-lg-3 order-lg-2">
                            <div class="card-profile-image">
                                <a href="javascript:;">
                                    @if (Model.user_img == null)
                                    {
                                        <img src="~/Content/argon-design-system-master/assets/img/faces/team-4.jpg" class="rounded-circle">
                                    }
                                    else
                                    {
                                        <img src="~/Content/LayoutCenter/ImgUser/@Model.user_img" class="rounded-circle">
                                    }

                                </a>
                            </div>
                        </div>
                        <div class="col-lg-4 order-lg-3 text-lg-right align-self-lg-center">
                            <div class="card-profile-actions py-4 mt-lg-0">
                                <form action="@Url.Action("AddFriend","UserPage")" method="post">
                                    <input type="hidden" name="user_friend_id" value="@Model.user_id" />
                                    @if (user != null)
                                    {
                                        Friend friend1 = db.Friends.FirstOrDefault(n => n.user_id == user.user_id && n.user_friend_id == Model.user_id && n.friend_status == false);
                                        Friend friend2 = db.Friends.FirstOrDefault(n => n.user_id == Model.user_id && n.user_friend_id == user.user_id && n.friend_status == false);
                                        Friend friend3 = db.Friends.FirstOrDefault(n => n.user_id == Model.user_id && n.user_friend_id == user.user_id && n.friend_status == true);
                                        if (user.user_id == Model.user_id)
                                        {
                                            <button type="button" class="btn btn-sm btn-info ml-4 float-left"><i class="fas fa-user"></i> Tôi</button>
                                        }
                                        else if (friend1 != null)
                                        {
                                            <button type="submit" class="btn btn-sm btn-info ml-4 float-left"><i class="fas fa-user-minus"></i> Hủy lời mời</button>
                                        }
                                        else if (friend2 != null)
                                        {
                                            <button type="submit" class="btn btn-sm btn-info ml-4 float-left"><i class="fas fa-user-plus"></i> Xác nhận</button>
                                        }
                                        else if (friend3 != null)
                                        {
                                            <button type="submit" class="btn btn-sm btn-info ml-4 float-left"><i class="fas fa-user-friends"></i> Bạn bè</button>
                                        }
                                        else
                                        {
                                            <button type="submit" class="btn btn-sm btn-info ml-4 float-left"><i class="fas fa-user-plus"></i> kết bạn</button>
                                        }
                                    }
                                    else
                                    {
                                        <button type="button" class="btn btn-sm btn-info ml-4 float-left">Đăng nhập kết bạn</button>
                                    }
                                </form>
                                    <a href="#" class="btn btn-sm btn-default float-right"><i class="fab fa-facebook-messenger"></i> nhắn tin</a>
                            </div>
                        </div>
                        <div class="col-lg-4 order-lg-1">
                            <div class="card-profile-stats d-flex justify-content-center">
                                <div>
                                    @{
                                        List<Friend> listFriend = db.Friends.Where(n => n.user_id == Model.user_id).ToList();
                                        int intCoutFriend = listFriend.Count();

                                    }
                                    <span class="heading">@intCoutFriend</span>
                                    <span class="description">Bạn bè</span>
                                </div>
                                <div>
                                    <span class="heading">@Model.user_popular</span>
                                    <span class="description">Nổi tiếng</span>
                                </div>
                                <div>
                                    @{var varSumMedal = Model.user_gold_medal + Model.user_bronze_medal + Model.user_silver_medal + Model.user_vip_medal;}
                                    <span class="heading">@varSumMedal</span>
                                    <span class="description">Huy hiệu</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-center mt-5">
                        <h3>@Model.user_nicename <i class="fas fa-chess-king"></i></h3>
                        @{
                            List<Technology_Care> TechnologyCare = db.Technology_Care.Where(n => n.user_id == Model.user_id).ToList();
                        }
                        <div class="h6 font-weight-300">
                            <i class="ni location_pin mr-2"></i>@foreach (var item2 in TechnologyCare)
                            {<span style="padding:1%">@item2.Technology.technology_name</span>}
                        </div>
                        <div class="h6 mt-4"><i class="ni business_briefcase-24 mr-2"></i><i class="fab fa-facebook-square"></i> @Model.user_link_facebok </div>
                        <div><i class="ni education_hat mr-2"></i><i class="fab fa-github-square"></i> @Model.user_link_github </div>
                    </div>
                    <div>

                        <div class="container-fluid gedf-wrapper">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="btn-group float-right" role="group" aria-label="Basic example">
                                        <button type="button" class="btn btn-secondary">Nổi tiếng<i class="far fa-snowflake text-success"></i></button>
                                        <button type="button" class="btn btn-secondary">Thưởng</button>
                                        <button type="button" class="btn btn-secondary">Xem</button>
                                    </div>
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="card">
                                        <div class="card-body">
                                            <div class="h5"> Thông tin</div>
                                            <div class="text-left"><i class="fas fa-envelope"></i> Email : @Model.user_email</div>
                                            <div class="h7">
                                                <i class="far fa-calendar-alt"></i>&nbsp;Ngày sinh: @Model.user_date_born
                                            </div>
                                            <div class="h7">
                                                <i class="fas fa-mobile-alt"></i>&nbsp;Số điện thoại : @Model.user_phone
                                            </div>
                                            <div class="h7">
                                                <i class="fas fa-venus-mars"></i>&nbsp;gới tính : @Model.user_sex
                                            </div>
                                        </div>
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item">
                                                <div class="h6 text-muted"><i class="fas fa-map-marker-alt"></i>&nbsp; Địa chỉ</div>
                                                <div class="h5">@Model.user_address</div>
                                            </li>
                                            <li class="list-group-item">
                                                <div class="h6 text-muted"><i class="fas fa-briefcase"></i>&nbsp; @Model.user_hobby_work</div>
                                                <div class="h5"> 12</div>
                                            </li>
                                            <li class="list-group-item">
                                                <div class="h6 text-muted"><i class="far fa-heart"></i>&nbsp; @Model.user_hobby</div>
                                                <div class="h5">  12</div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-md-8 gedf-main">

                                    @Html.Action("Post", "UserPage", new { id = Model.user_id })
                                    
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <footer class="footer">
        <div class="container">

            <div class="row align-items-center justify-content-md-between">
                <div class="col-md-6">
                    <div class="copyright">
                        &copy; 2020 <a href="" target="_blank">Creative Tim</a>.
                    </div>
                </div>
                <div class="col-md-6">
                    <ul class="nav nav-footer justify-content-end">
                        <li class="nav-item">
                            <a href="" class="nav-link" target="_blank">Creative Tim</a>
                        </li>
                        <li class="nav-item">
                            <a href="" class="nav-link" target="_blank">About Us</a>
                        </li>
                        <li class="nav-item">
                            <a href="" class="nav-link" target="_blank">Blog</a>
                        </li>
                        <li class="nav-item">
                            <a href="" class="nav-link" target="_blank">License</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
</div>
